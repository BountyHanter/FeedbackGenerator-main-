# Введение

Этот документ написан для того, чтобы дать полное представление о текущем состоянии проекта и его проблемах. Он предназначен для человека, который поможет разобраться в архитектуре, технологиях и коде, а затем предложит гайд по рефакторингу: что исправить, какие технологии использовать и как правильно переделать систему.  

### **Краткое описание проекта**  
Проект представляет собой микросервисную систему для автоматического сбора отзывов и генерации ответов на различных платформах (2ГИС, Фламп, Яндекс и т. д.). Он включает в себя несколько микросервисов, каждый из которых отвечает за работу с определённой платформой: собирает отзывы, формирует ответ с использованием ChatGPT и отправляет его обратно.  

### **Текущие проблемы**  
В процессе разработки кодовая база проекта стала запутанной, что делает его поддержку и расширение сложными. Основные проблемы:  

1. **Несогласованные API** — микросервисы возвращают данные в разных форматах, что мешает взаимодействию между ними.  
2. **Сложный, трудно читаемый код** — некоторые функции перегружены логикой, код плохо структурирован, из-за чего его сложно модифицировать.  
3. **Ошибки в выборе технологий** — некоторые инструменты и подходы использованы неправильно, что приводит к проблемам в масштабируемости и удобстве работы.  
4. **Отсутствие стандартов в обработке данных** — разные микросервисы работают по разным принципам, что создаёт хаос в архитектуре.  
5. **Общая сложность поддержки** — в текущем виде проект трудно поддерживать и развивать.  

### **Цель документа**  
- Дать полное описание архитектуры и логики проекта.  
- Разобрать используемые технологии и их проблемы.  
- Подготовить информацию для разработки гайда по рефакторингу: какие технологии лучше использовать, как организовать код, какие ошибки исправить.  

После прочтения документа специалист сможет понять, как сейчас работает система, выявить слабые места и дать рекомендации по исправлению проблем.

---

## Общая концепция проекта

### 1. Для чего создан сервис?

Сервис разработан для автоматизации ответов на пользовательские отзывы на различных площадках (например, 2ГИС, Фламп и др.). Владельцы бизнеса или их представители часто сталкиваются с большим количеством отзывов, которые требуют оперативного реагирования. Вручную отвечать на все отзывы трудозатратно, особенно если они поступают на нескольких площадках одновременно.

Сервис позволяет автоматизировать этот процесс, используя ChatGPT. Он анализирует отзывы и формирует ответы на основе заранее заданных пользователем промптов и правил. Таким образом, пользователи могут минимизировать временные затраты, обеспечивая при этом качественное взаимодействие с клиентами.

### 2. Какие задачи решает сервис?

- Автоматический сбор отзывов с различных площадок.
- Анализ содержания отзывов и генерация ответов на основе заданных пользователем правил.
- Автоматическая публикация ответов.
- Возможность редактирования и удаления опубликованных ответов.
- Отображение всех отзывов и ответов на сайте для удобного мониторинга.

### 3. Какие сервисы поддерживает система?

На данный момент реализована поддержка следующих площадок:

- **Фламп**
- **2ГИС**

Планируется расширение списка поддерживаемых сервисов, включая:

- **Zoon**
- **Яндекс**
- **Google**

Яндекс и Google представляют особые трудности, так как:

- У Яндекса используется большое количество неизвестных ключей, необходимых для получения отзывов.
- У Google в ответах на запросы вместо структурированных данных возвращается HTML-код, что усложняет обработку.

**Реализацию запросов поручим кому нибудь кто сможет это сделать**


### 4. Как пользователи взаимодействуют с сервисом?

1. **Настройка системы**
     - Пользователь регистрируется в сервисе и проходит авторизацию.
     - В веб-интерфейсе указываются данные для доступа к нужным площадкам (например, логины, API-ключи, авторизационные токены и т. д.).
     - Задаются индивидуальные промпты и правила генерации ответов (в специальных полях веб-интерфейса).
     - Возможен выбор предустановленных шаблонов для генерации ответов.
     - Разные промпты можно привязывать к разным площадкам.

2. **Работа системы**
      - **Сбор отзывов:** Микросервисы (например, 2ГИС и Фламп) авторизуются на площадках и запрашивают новые отзывы через HTTP-запросы.
     - **Частота обновления:** Проверка новых отзывов происходит раз в сутки.
     - **Обход защит:** Для борьбы с антибот-системами сервис использует прокси и задержки между запросами.

3. **Генерация ответов**
      - Существует отдельный микросервис, который отправляет отзывы в ChatGPT и получает готовые ответы.
      - В дальнейшем пользователи смогут задавать дополнительные параметры генерации, но этот функционал пока не реализован.

4. **Публикация ответов**
      - Ответы автоматически публикуются на соответствующих площадках.
      - Пользователь может редактировать или удалять ответы после публикации.

5. **Отображение отзывов и ответов**
      - На веб-сайте сервис отображает все собранные отзывы.
      - Отзывы загружаются в память микросервисов и доступны пользователям через веб-интерфейс.
      - В интерфейсе можно просматривать старые отзывы и их ответы.
      - В текущей версии метрики (например, количество автоматических ответов) отсутствуют, но планируется их добавление.

---
